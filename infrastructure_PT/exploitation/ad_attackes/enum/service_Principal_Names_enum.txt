
Service Principal Names -  SPN:
-------------------------------
applications like Exchange, SQL, or Internet Information Services (IIS)
By enumerating all registered SPNs in the domain, we can obtain the IP address and port number
of applications running on servers integrated with the target Active Directory, limiting the need for
a broad port scan

==========================

PowerShell script to detect registered service principal names:

$domainObj = [System.DirectoryServices.ActiveDirectory.Domain]::GetCurrentDomain()
$PDC = ($domainObj.PdcRoleOwner).Name
$SearchString = "LDAP://"
$SearchString += $PDC + "/"
$DistinguishedName = "DC=$($domainObj.Name.Replace('.', ',DC='))"
$SearchString += $DistinguishedName
$Searcher = New-Object System.DirectoryServices.DirectorySearcher([ADSI]$SearchString)
$objDomain = New-Object System.DirectoryServices.DirectoryEntry
$Searcher.SearchRoot = $objDomain
$Searcher.filter="serviceprincipalname=*http*"
$Result = $Searcher.FindAll()
Foreach($obj in $Result)
{
	Foreach($prop in $obj.Properties)
	{
		$prop
	}
}

*************************************

++now we can do a Nslookup of serviceprincipalname entry++
